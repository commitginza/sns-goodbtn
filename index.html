<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SNS Quick Launcher</title>
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root {
      /* Android でアプリが無い場合に Web へフォールバックするまでの待機時間 (ms) */
      --android-fallback-delay: 1500;
    }
  </style>
</head>
<body class="bg-gray-100 text-gray-800 min-h-screen flex flex-col items-center py-10">
  <h1 class="text-2xl font-bold mb-8">SNS クイックランチャー</h1>

  <!-- ===== ボタン用テンプレート ===== -->
  <template id="btn-template">
    <button class="flex items-center gap-4 w-full max-w-md px-4 py-3 mb-4 rounded-2xl shadow hover:shadow-lg active:scale-[0.98] transition bg-white text-left">
      <img class="w-10 h-10 object-contain" />
      <span class="flex-1 font-semibold text-lg truncate"></span>
    </button>
  </template>

  <div id="buttons" class="w-full max-w-md"></div>

  <script>
    /**
     * ディープリンク → アプリ起動失敗時に Web へフォールバック
     * 1. hidden iframe or location.href で custom scheme / intent を呼ぶ
     * 2. setTimeout で https へ遷移 (アプリが起動すれば JS 実行中断)
     */
    function openWithSmartFallback(deepLink, webUrl) {
      const ua = navigator.userAgent.toLowerCase();
      const isAndroid = ua.includes('android');
      const isIOS = /iphone|ipad|ipod/.test(ua);

      if (isAndroid) {
        // --- Android: フォールバックあり ---
        const targetUrl = deepLink.intent || deepLink.scheme || webUrl;
        const delay = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--android-fallback-delay'));

        const timer = setTimeout(() => {
          window.location.href = webUrl;
        }, delay);

        // アプリが前面に来たらキャンセル
        document.addEventListener(
          'visibilitychange',
          () => {
            if (document.visibilityState === 'hidden') {
              clearTimeout(timer);
            }
          },
          { once: true }
        );

        window.location.href = targetUrl;
      } else if (isIOS) {
        // --- iOS: フォールバックなし → ユーザがキャンセルしても画面遷移しない ---
        const targetUrl = deepLink.scheme || webUrl;
        window.location.href = targetUrl;
      } else {
        // その他 (デスクトップなど) は単に Web
        window.open(webUrl, '_blank');
      }
    }

    /* ----------------- リンク定義 ----------------- */
    const links = [
      // --- コミット銀座 ---
      {
        label: 'TikTok (コミット銀座)',
        icon: 'https://images.icon-icons.com/3041/PNG/512/tiktok_logo_icon_189233.png',
        deep: {
          scheme: 'tiktok://user/@commit_ginza',
          intent: 'intent://www.tiktok.com/@commit_ginza#Intent;package=com.zhiliaoapp.musically;scheme=https;end'
        },
        web: 'https://www.tiktok.com/@commit_ginza'
      },
      {
        label: 'Instagram (コミット銀座)',
        icon: 'https://static.xx.fbcdn.net/rsrc.php/v4/yx/r/tBxa1IFcTQH.png',
        deep: {
          scheme: 'instagram://user?username=commit_official'
        },
        web: 'https://www.instagram.com/commit_official?igsh=cXQxcGEzdGlob3Nk'
      },
      {
        label: 'X / Twitter (コミット銀座)',
        icon: 'https://cdn.cms-twdigitalassets.com/content/dam/about-twitter/x/brand-toolkit/logo-black.png.twimg.2560.png',
        deep: {
          scheme: 'twitter://user?screen_name=commitginza'
        },
        web: 'https://x.com/commitginza'
      },
      {
        label: 'Facebook (コミット銀座)',
        icon: 'https://upload.wikimedia.org/wikipedia/commons/thumb/0/05/Facebook_Logo_%282019%29.png/1200px-Facebook_Logo_%282019%29.png',
        deep: {
          scheme: 'fb://facewebmodal/f?href=https://www.facebook.com/commitginza'
        },
        web: 'https://www.facebook.com/commitginza'
      },
      {
        label: 'YouTube (コミット銀座)',
        icon: 'https://images.icon-icons.com/2699/PNG/512/youtube_logo_icon_168737.png',
        deep: {
          scheme: 'vnd.youtube://youtube.com/@commit-ginza'
        },
        web: 'https://youtube.com/@commit-ginza'
      },

      // --- 大津祐樹 ---
      {
        label: 'TikTok (大津祐樹)',
        icon: 'https://images.icon-icons.com/3041/PNG/512/tiktok_logo_icon_189233.png',
        deep: {
          scheme: 'tiktok://user/@o2yuki0324'
        },
        web: 'https://www.tiktok.com/@o2yuki0324'
      },
      {
        label: 'Instagram (大津祐樹)',
        icon: 'https://static.xx.fbcdn.net/rsrc.php/v4/yx/r/tBxa1IFcTQH.png',
        deep: {
          scheme: 'instagram://user?username=o2yuki'
        },
        web: 'https://www.instagram.com/o2yuki?igsh=MXM0eHBhdTZ4bm9kZg=='
      },

      // --- スペリオ城北 ---
      {
        label: 'Instagram (スペリオ城北)',
        icon: 'https://static.xx.fbcdn.net/rsrc.php/v4/yx/r/tBxa1IFcTQH.png',
        deep: {
          scheme: 'instagram://user?username=sperio.johoku'
        },
        web: 'https://www.instagram.com/sperio.johoku?igsh=MWdzOWZsc3hpbHpqMg=='
      },

      // --- フットボールアシスト ---
      {
        label: 'Instagram (フットボールアシスト)',
        icon: 'https://static.xx.fbcdn.net/rsrc.php/v4/yx/r/tBxa1IFcTQH.png',
        deep: {
          scheme: 'instagram://user?username=f00tballassist'
        },
        web: 'https://www.instagram.com/f00tballassist?igsh=ZzZtYmxiNXJiNDNp'
      },
      {
        label: 'X / Twitter (フットボールアシスト)',
        icon: 'https://cdn.cms-twdigitalassets.com/content/dam/about-twitter/x/brand-toolkit/logo-black.png.twimg.2560.png',
        deep: {
          scheme: 'twitter://user?screen_name=footballassist1'
        },
        web: 'https://x.com/footballassist1'
      }
    ];

    /* ----------------- DOM 生成 ----------------- */
    const container = document.getElementById('buttons');
    const tpl = document.getElementById('btn-template').content;

    links.forEach(({ label, icon, deep, web }) => {
      const clone = tpl.cloneNode(true);
      const btn = clone.querySelector('button');
      const img = clone.querySelector('img');
      const span = clone.querySelector('span');

      img.src = icon;
      img.alt = label;
      span.textContent = label;
      btn.addEventListener('click', () => openWithSmartFallback(deep, web));
      container.appendChild(clone);
    });
  </script>
</body>
</html>
